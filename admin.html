<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard | ZYPSO Mart</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .admin-container { padding: 20px; max-width: 1400px; margin: 0 auto; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); min-height: 100vh; }
        .admin-header { background: var(--white); padding: 20px; border-radius: var(--radius-xl); margin-bottom: 20px; box-shadow: var(--shadow); display: flex; justify-content: space-between; align-items: center; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--white); padding: 25px; border-radius: var(--radius-xl); box-shadow: var(--shadow); text-align: center; transition: all 0.3s ease; border-top: 4px solid var(--primary); }
        .stat-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); }
        .stat-card h3 { color: var(--gray); font-size: 14px; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .stat-card .stat-value { font-size: 32px; font-weight: 800; color: var(--dark); margin: 10px 0; }
        .stat-card .stat-change { font-size: 12px; color: var(--primary); }
        .stat-card i { font-size: 40px; margin-bottom: 15px; color: var(--primary); opacity: 0.8; }
        .card { background: var(--white); padding: 25px; border-radius: var(--radius-xl); margin-bottom: 25px; box-shadow: var(--shadow); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .card-header h3 { margin: 0; color: var(--dark); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: var(--gray-light); color: var(--dark); font-weight: 600; text-transform: uppercase; font-size: 12px; letter-spacing: 0.5px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid var(--gray-light); font-size: 14px; }
        tr:hover { background: var(--gray-light); }
        .btn-small { padding: 6px 12px; border-radius: var(--radius); font-size: 12px; border: none; cursor: pointer; margin: 2px; }
        .btn-edit { background: var(--info); color: white; }
        .btn-delete { background: var(--danger); color: white; }
        .btn-featured { background: var(--gray-light); color: var(--gray); }
        .btn-featured.active { background: var(--warning); color: white; }
        .status-select { padding: 8px 12px; border-radius: var(--radius); border: 1px solid var(--gray-light); font-size: 12px; }
        .stock-input, .price-input { width: 70px; padding: 6px; border: 1px solid var(--gray-light); border-radius: var(--radius); }
        .unit-select { padding: 6px; border: 1px solid var(--gray-light); border-radius: var(--radius); font-size: 12px; }
        .product-row { display: flex; align-items: center; gap: 10px; }
        .product-thumb { width: 50px; height: 50px; object-fit: cover; border-radius: var(--radius); }
        .category-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: var(--gray-light); border-radius: var(--radius); margin-bottom: 8px; }
        .location-section { background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 20px; border-radius: var(--radius-lg); margin: 20px 0; }
        .map-coordinates { display: flex; gap: 10px; margin: 10px 0; }
        .map-coordinates input { flex: 1; }
        #map-preview { background: var(--gray-light); padding: 15px; border-radius: var(--radius); text-align: center; margin: 10px 0; }
        @media (max-width: 768px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }
    </style>
</head>
<body onload="initAdmin()">
    <div class="admin-container">
        <!-- Header -->
        <div class="admin-header">
            <div>
                <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
                <p>Manage your store efficiently</p>
            </div>
            <div>
                <a href="index.html" class="btn-primary">
                    <i class="fas fa-store"></i> View Store
                </a>
                <button onclick="exportData('orders')" class="btn-secondary">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <i class="fas fa-rupee-sign"></i>
                <h3>Total Revenue</h3>
                <div class="stat-value" id="total-rev-val">â‚¹0</div>
                <div class="stat-change">From all deliveries</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-shopping-cart"></i>
                <h3>Total Orders</h3>
                <div class="stat-value" id="total-orders-val">0</div>
                <div class="stat-change">All time orders</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock"></i>
                <h3>Pending Orders</h3>
                <div class="stat-value" id="pending-orders-val">0</div>
                <div class="stat-change">Need action</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-check-circle"></i>
                <h3>Delivered</h3>
                <div class="stat-value" id="delivered-orders-val">0</div>
                <div class="stat-change">Completed orders</div>
            </div>
        </div>

        <!-- Revenue Chart -->
        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-chart-line"></i> Revenue Analytics</h3>
                <div>
                    <input type="date" id="filter-start">
                    <input type="date" id="filter-end" style="margin: 0 10px;">
                    <button onclick="applyFilters()" class="btn-primary">Filter</button>
                </div>
            </div>
            <canvas id="revenueChart" height="100"></canvas>
        </div>

        <!-- Two Column Layout -->
        <div class="grid-2">
            <!-- Orders -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-list-alt"></i> Recent Orders</h3>
                    <button onclick="document.getElementById('admin-orders').scrollIntoView()" class="btn-text">
                        View All <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <div style="overflow-x:auto; max-height: 500px; overflow-y:auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Customer</th>
                                <th>Items</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="admin-orders"></tbody>
                    </table>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="card">
                <h3><i class="fas fa-cogs"></i> Quick Actions</h3>
                <div class="grid-3" style="margin-top: 20px;">
                    <button onclick="document.getElementById('add-product-section').scrollIntoView()" class="btn-primary">
                        <i class="fas fa-plus"></i> Add Product
                    </button>
                    <button onclick="document.getElementById('category-section').scrollIntoView()" class="btn-secondary">
                        <i class="fas fa-tags"></i> Manage Categories
                    </button>
                    <button onclick="document.getElementById('settings-section').scrollIntoView()" class="btn-secondary">
                        <i class="fas fa-sliders-h"></i> Settings
                    </button>
                </div>
                
                <!-- Inventory Summary -->
                <div style="margin-top: 30px;">
                    <h4><i class="fas fa-boxes"></i> Inventory Summary</h4>
                    <div id="inventory-summary" style="margin-top: 15px;">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Management -->
        <div class="card" id="add-product-section">
            <h3><i class="fas fa-plus-circle"></i> Add New Product</h3>
            <div class="grid-3">
                <input type="text" id="p-name" placeholder="Product Name" class="capsule-input">
                <input type="number" id="p-price" placeholder="Price (â‚¹)" class="capsule-input">
                <select id="p-unit" class="capsule-input">
                    <option value="piece">per Piece</option>
                    <option value="kg">per kg</option>
                    <option value="gram">per gram</option>
                    <option value="bunch">per bunch</option>
                    <option value="pack">per pack</option>
                    <option value="dozen">per dozen</option>
                </select>
                <input type="text" id="p-img" placeholder="Image URL" class="capsule-input">
                <input type="text" id="p-desc" placeholder="Description" class="capsule-input">
                <select id="p-category" class="capsule-input"></select>
                <input type="number" id="p-stock" placeholder="Stock Quantity" value="10" class="capsule-input">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="p-featured">
                    <label for="p-featured">Featured Product</label>
                </div>
                <button onclick="addProduct()" class="btn-primary">
                    <i class="fas fa-save"></i> Add Product
                </button>
            </div>
        </div>

        <!-- Category Management -->
        <div class="card" id="category-section">
            <h3><i class="fas fa-tags"></i> Category Management</h3>
            <div class="grid-2">
                <div>
                    <h4>Add New Category</h4>
                    <input type="text" id="new-cat-name" placeholder="Category Name" class="capsule-input">
                    <input type="text" id="new-cat-icon" placeholder="Emoji Icon (ðŸ“¦)" value="ðŸ“¦" class="capsule-input">
                    <button onclick="addCategory()" class="btn-primary">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>
                <div>
                    <h4>Existing Categories</h4>
                    <div id="admin-cat-list"></div>
                </div>
            </div>
        </div>

        <!-- Product Inventory -->
        <div class="card">
            <h3><i class="fas fa-box-open"></i> Product Inventory</h3>
            <div style="overflow-x:auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Stock Status</th>
                            <th>Price/Unit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="admin-inventory"></tbody>
                </table>
            </div>
        </div>

        <!-- Global Settings -->
        <div class="card" id="settings-section">
            <h3><i class="fas fa-sliders-h"></i> Global Settings</h3>
            
            <!-- Shop Status -->
            <div class="setting-item">
                <label>Shop Status:</label>
                <div style="display:flex; align-items:center; gap:15px; margin:10px 0;">
                    <label class="switch">
                        <input type="checkbox" id="shop-toggle">
                        <span class="slider"></span>
                    </label>
                    <span id="status-label" style="font-weight:600;">OPEN</span>
                </div>
            </div>
            
            <!-- Location Settings -->
            <div class="location-section">
                <h4><i class="fas fa-map-marker-alt"></i> Shop Location & Delivery Settings</h4>
                
                <div class="map-coordinates">
                    <input type="number" step="0.0001" id="shop-lat" placeholder="Latitude" class="capsule-input">
                    <input type="number" step="0.0001" id="shop-lng" placeholder="Longitude" class="capsule-input">
                </div>
                
                <input type="text" id="shop-address" placeholder="Shop Address" class="capsule-input">
                
                <div style="display:flex; gap:10px; margin:10px 0;">
                    <button id="use-current-location" class="btn-secondary">
                        <i class="fas fa-crosshairs"></i> Use Current Location
                    </button>
                    <button id="lookup-address" class="btn-secondary">
                        <i class="fas fa-search"></i> Lookup Address
                    </button>
                </div>
                
                <div id="map-preview">
                    <p><i class="fas fa-info-circle"></i> Set shop location for distance calculations</p>
                </div>
                
                <div class="grid-3" style="margin-top: 20px;">
                    <div>
                        <label>Base Delivery Charge (â‚¹):</label>
                        <input type="number" id="delivery-base-input" class="capsule-input" value="20">
                    </div>
                    <div>
                        <label>Charge per Km (â‚¹):</label>
                        <input type="number" id="charge-per-km" class="capsule-input" value="10">
                    </div>
                    <div>
                        <label>Min Order Amount (â‚¹):</label>
                        <input type="number" id="min-order-input" class="capsule-input" value="0">
                    </div>
                </div>
                
                <div style="margin-top: 15px;">
                    <label>Free Delivery Above (â‚¹):</label>
                    <input type="number" id="free-delivery-input" class="capsule-input" value="500">
                </div>
            </div>
            
            <!-- Contact Settings -->
            <div style="margin-top: 25px;">
                <label>Support Number:</label>
                <input type="tel" id="support-number-input" class="capsule-input" placeholder="Customer support number">
            </div>
            
            <button onclick="updateShopSettings()" class="btn-primary" style="width:100%; margin-top: 20px;">
                <i class="fas fa-save"></i> Save All Settings
            </button>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3><i class="fas fa-edit"></i> Edit Product</h3>
            <input type="hidden" id="edit-id">
            <input type="text" id="edit-name" placeholder="Product Name" class="capsule-input">
            <input type="number" id="edit-price" placeholder="Price" class="capsule-input">
            <select id="edit-unit" class="capsule-input">
                <option value="piece">Piece</option>
                <option value="kg">kg</option>
                <option value="gram">gram</option>
                <option value="bunch">bunch</option>
                <option value="pack">pack</option>
            </select>
            <input type="text" id="edit-img" placeholder="Image URL" class="capsule-input">
            <textarea id="edit-desc" placeholder="Description" class="capsule-input" rows="3"></textarea>
            <input type="text" id="edit-category" placeholder="Category" class="capsule-input">
            <input type="number" id="edit-stock" placeholder="Stock Quantity" class="capsule-input">
            <div style="display: flex; align-items: center; gap: 10px; margin: 10px 0;">
                <input type="checkbox" id="edit-featured">
                <label for="edit-featured">Featured Product</label>
            </div>
            <div style="display: flex; gap: 10px;">
                <button onclick="saveEdit()" class="btn-primary" style="flex: 1;">
                    <i class="fas fa-save"></i> Save Changes
                </button>
                <button onclick="document.getElementById('edit-modal').classList.remove('active')" class="btn-secondary" style="flex: 1;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="order-details-modal" class="modal"></div>

    <script type="module" src="admin.js"></script>
    
    <style>
        .switch { position: relative; display: inline-block; width: 60px; height: 34px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(26px); }
        .slider.round { border-radius: 34px; }
        .slider.round:before { border-radius: 50%; }
        .notification { position: fixed; top: 20px; right: 20px; padding: 15px 20px; background: var(--white); border-radius: var(--radius); box-shadow: var(--shadow-lg); z-index: 9999; transform: translateX(150%); transition: transform 0.3s ease; display: flex; align-items: center; gap: 10px; }
        .notification.show { transform: translateX(0); }
        .notification.success { border-left: 4px solid var(--primary); }
        .notification.error { border-left: 4px solid var(--danger); }
        .btn-text { background: none; border: none; color: var(--primary); cursor: pointer; font-weight: 600; }
    </style>
</body>
</html>